{
    "format": {
        "properties": {
            "issues": {
                "items": {
                    "properties": {
                        "category": {
                            "enum": [
                                "security",
                                "bug",
                                "performance",
                                "reliability",
                                "maintainability",
                                "testing",
                                "style",
                                "documentation",
                                "other"
                            ],
                            "type": "string"
                        },
                        "details": {
                            "type": "string"
                        },
                        "fix": {
                            "type": "string"
                        },
                        "lineEnd": {
                            "type": "integer"
                        },
                        "lineStart": {
                            "type": "integer"
                        },
                        "path": {
                            "type": "string"
                        },
                        "problematicCode": {
                            "type": "string"
                        },
                        "severity": {
                            "enum": [
                                "critical",
                                "high",
                                "medium",
                                "low"
                            ],
                            "type": "string"
                        },
                        "summary": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "path",
                        "lineStart",
                        "lineEnd",
                        "severity",
                        "category",
                        "problematicCode",
                        "details",
                        "summary"
                    ],
                    "type": "object"
                },
                "type": "array"
            },
            "truncated": {
                "type": "boolean"
            }
        },
        "required": [
            "issues"
        ],
        "type": "object"
    },
    "messages": [
        {
            "content": "You are an AI code reviewer. Follow all policy rules:\n- Only reference lines that include [Line N] markers from the diff.\n- Severity must be one of: critical, high, medium, low (see definitions in user prompt).\n- Categories must be one of: security, bug, performance, reliability, maintainability, testing, style, documentation, other.\n- Always prefer actionable, evidence-based findings. If unsure, omit the issue.\n- Provide concise summaries and practical fixes.",
            "role": "system"
        },
        {
            "content": "You are reviewing a pull request. Overview:\nRepository: WOR/openvsx\nPull Request: 42\nTotal files: 20\nTotal additions: 1069, deletions: 58\nFiles:\n- server/src/main/java/org/eclipse/openvsx/publish/PublishConfig.java (+24/-0)\n- server/src/main/java/org/eclipse/openvsx/publish/PublishExtensionVersionHandler.java (+25/-3)\n- server/src/main/java/org/eclipse/openvsx/security/SecurityConfig.java (+169/-16)\n- server/src/main/java/org/eclipse/openvsx/security/LdapConnectionTest.java (+64/-0)\n- webui/src/default/login.tsx (+37/-19)\n- server/src/main/java/org/eclipse/openvsx/UserService.java (+27/-0)\n- server/src/main/java/org/eclipse/openvsx/security/GroupRoleResolver.java (+70/-0)\n- server/src/test/java/org/eclipse/openvsx/RegistryAPITest.java (+11/-4)\n- server/src/main/java/org/eclipse/openvsx/web/LdapTestController.java (+49/-0)\n- server/src/test/java/org/eclipse/openvsx/UserAPITest.java (+6/-0)\n- webui/src/hooks/useCsrfToken.ts (+13/-0)\n- server/src/main/java/org/eclipse/openvsx/security/LdapUserService.java (+130/-0)\n- server/src/test/java/org/eclipse/openvsx/TestSearchConfig.java (+14/-11)\n- webui/src/components/LdapLoginForm.tsx (+80/-0)\n- server/src/main/java/org/eclipse/openvsx/UserAPI.java (+28/-5)\n- server/src/main/java/org/eclipse/openvsx/security/SessionConfig.java (+24/-0)\n- server/src/main/java/org/eclipse/openvsx/security/LdapAuthenticationSuccessHandler.java (+110/-0)\n- server/src/main/java/org/eclipse/openvsx/security/LdapConfig.java (+83/-0)\n- server/src/test/java/org/eclipse/openvsx/cache/CacheServiceTest.java (+9/-0)\n- server/src/main/java/org/eclipse/openvsx/security/UserAttributesMapper.java (+96/-0)\nMin severity: MEDIUM\n\n\nAnalyze this diff chunk. Only report issues where added lines include [Line N] markers.\n\nCRITICAL ANALYSIS AREAS:\nðŸ”´ SECURITY: SQL injection, XSS, CSRF, authentication/authorization flaws, input validation, data exposure, cryptography\nðŸ”´ BUGS & LOGIC: Null dereferences, array bounds, race conditions, deadlocks, infinite loops, incorrect algorithms, edge cases\nðŸ”´ PERFORMANCE: Memory leaks, inefficient queries, quadratic or worse algorithms, redundant computation, resource exhaustion\nðŸ”´ RELIABILITY: Error handling gaps, exception swallowing, transactional integrity, data consistency, retries/backoff\nðŸ”´ MAINTAINABILITY: Excessive complexity, duplication, tight coupling, missing docs, obscure naming\nðŸ”´ TESTING: Missing coverage, weak assertions, brittle fixtures, missing mocks/stubs\n\nSEVERITY GUIDELINES:\n- CRITICAL: Security vulnerabilities, data corruption, crashes, production outages\n- HIGH: Logic flaws, major performance regressions, reliability risks, significant bugs\n- MEDIUM: Maintainability problems, moderate performance issues, code-quality gaps\n- LOW: Style inconsistencies, documentation gaps, minor optimisations\n\nCRITICAL INSTRUCTIONS:\n1. Hunt for subtle bugs that can trigger runtime failures in NEW code.\n2. Flag any security vulnerabilities introduced on ADDED lines.\n3. Evaluate performance impact of the NEW changes (algorithmic or resource usage).\n4. Skip reporting if confidence is low or evidence is missing.\n5. Never infer line numbersâ€”only use explicit [Line N] tags.\n6. The `problematicCode` field MUST contain the exact added diff lines (including [Line N] markers) that demonstrate the issue.\n\nDiff chunk:\ndiff --git src://server/src/main/java/org/eclipse/openvsx/publish/PublishConfig.java dst://server/src/main/java/org/eclipse/openvsx/publish/PublishConfig.java\nnew file mode 100644\nindex 00000000..f7813882\n--- /dev/null\n+++ dst://server/src/main/java/org/eclipse/openvsx/publish/PublishConfig.java\n@@ -0,0 +1,24 @@\n[Line 1] +/********************************************************************************\n[Line 2] + * Copyright (c) 2025 Eclipse Foundation and others\n[Line 3] + *\n[Line 4] + * This program and the accompanying materials are made available under the\n[Line 5] + * terms of the Eclipse Public License v. 2.0 which is available at\n[Line 6] + * http://www.eclipse.org/legal/epl-2.0.\n[Line 7] + *\n[Line 8] + * SPDX-License-Identifier: EPL-2.0\n[Line 9] + ********************************************************************************/\n[Line 10] +package org.eclipse.openvsx.publish;\n[Line 11] +\n[Line 12] +import org.springframework.beans.factory.annotation.Value;\n[Line 13] +import org.springframework.stereotype.Component;\n[Line 14] +\n[Line 15] +@Component\n[Line 16] +public class PublishConfig {\n[Line 17] +\n[Line 18] +    @Value(\"${ovsx.publish.allowNamespaceAutoCreation:true}\")\n[Line 19] +    private boolean allowNamespaceAutoCreation;\n[Line 20] +\n[Line 21] +    public boolean isAllowNamespaceAutoCreation() {\n[Line 22] +        return allowNamespaceAutoCreation;\n[Line 23] +    }\n[Line 24] +}\n\\ No newline at end of file\ndiff --git src://server/src/main/java/org/eclipse/openvsx/security/SecurityConfig.java dst://server/src/main/java/org/eclipse/openvsx/security/SecurityConfig.java\nindex 4900dcfd..0ffe4aad 100644\n--- src://server/src/main/java/org/eclipse/openvsx/security/SecurityConfig.java\n+++ dst://server/src/main/java/org/eclipse/openvsx/security/SecurityConfig.java\n@@ -2,76 +2,229 @@\n[Line 2]   * Copyright (c) 2020 TypeFox and others\n[Line 3]   *\n[Line 4]   * This program and the accompanying materials are made available under the\n[Line 5]   * terms of the Eclipse Public License v. 2.0 which is available at\n[Line 6]   * http://www.eclipse.org/legal/epl-2.0.\n[Line 7]   *\n[Line 8]   * SPDX-License-Identifier: EPL-2.0\n[Line 9]   ********************************************************************************/\n[Line 10]  package org.eclipse.openvsx.security;\n[Line 11]  \n[Line 12] +import java.util.Collection;\n[Line 13] +import test.error\n[Line 14]  import org.apache.commons.lang3.StringUtils;\n[Line 15] +import org.slf4j.Logger;\n[Line 16] +import org.slf4j.LoggerFactory;\n[Line 17] +import org.springframework.beans.factory.annotation.Autowired;\n[Line 18]  import org.springframework.beans.factory.annotation.Value;\n[Line 19] +import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n[Line 20]  import org.springframework.context.annotation.Bean;\n[Line 21]  import org.springframework.context.annotation.Configuration;\n[Line 22] +import org.springframework.ldap.core.DirContextOperations;\n[Line 23]  import org.springframework.security.config.annotation.web.builders.HttpSecurity;\n[Line 24]  import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;\n[Line 25] +import org.springframework.security.core.GrantedAuthority;\n[Line 26] +import org.springframework.security.core.userdetails.UserDetails;\n[Line 27] +import org.springframework.security.ldap.authentication.BindAuthenticator;\n[Line 28] +import org.springframework.security.ldap.authentication.LdapAuthenticationProvider;\n[Line 29] +import org.springframework.security.ldap.search.FilterBasedLdapUserSearch;\n[Line 30] +import org.springframework.security.ldap.userdetails.LdapAuthoritiesPopulator;\n[Line 31]  import org.springframework.security.web.SecurityFilterChain;\n[Line 32]  import org.springframework.security.web.authentication.Http403ForbiddenEntryPoint;\n[Line 33]  import org.springframework.security.web.servlet.util.matcher.PathPatternRequestMatcher;\n[Line 34]  import org.springframework.security.web.util.matcher.RequestMatcher;\n[Line 35]  \n[Line 36] +import jakarta.annotation.PostConstruct;\n[Line 37] +\n[Line 38]  @Configuration\n[Line 39]  @EnableWebSecurity\n[Line 40]  public class SecurityConfig {\n[Line 41]  \n[Line 42] +    private static final Logger logger = LoggerFactory.getLogger(SecurityConfig.class);\n[Line 43] +\n[Line 44]      @Value(\"${ovsx.webui.url:}\")\n[Line 45]      String webuiUrl;\n[Line 46]  \n[Line 47]      @Value(\"${ovsx.webui.frontendRoutes:/extension/**,/namespace/**,/user-settings/**,/admin-dashboard/**}\")\n[Line 48]      String[] frontendRoutes;\n[Line 49]  \n[Line 50] +    @Value(\"${ovsx.ldap.userSearchBase:}\")\n[Line 51] +    String ldapUserSearchBase;\n[Line 52] +\n[Line 53] +    @Value(\"${ovsx.ldap.userSearchFilter:(uid={0})}\")\n[Line 54] +    String ldapUserSearchFilter;\n[Line 55] +\n[Line 56] +    @Value(\"${ovsx.ldap.groupSearchBase:}\")\n[Line 57] +    String ldapGroupSearchBase;\n[Line 58] +\n[Line 59] +    @Value(\"${ovsx.ldap.groupSearchFilter:(member=uid={0},{1},{2})}\")\n[Line 60] +    String ldapGroupSearchFilter;\n[Line 61] +\n[Line 62] +    @Value(\"${ovsx.ldap.adminGroups:admins,openvsx-admins}\")\n[Line 63] +    String ldapAdminGroups;\n[Line 64] +\n[Line 65] +    @Value(\"${ovsx.ldap.base:}\")\n[Line 66] +    String ldapBase;\n[Line 67] +\n[Line 68] +    @Value(\"${ovsx.cors.allowedOrigins:http://localhost:3000}\")\n[Line 69] +    String corsAllowedOrigins;\n[Line 70] +\n[Line 71] +    @Value(\"${ovsx.cors.allowedMethods:GET,POST,PUT,DELETE,OPTIONS}\")\n[Line 72] +    String corsAllowedMethods;\n[Line 73] +\n[Line 74] +    private final LdapConfig ldapConfig;\n[Line 75] +    private final LdapUserService ldapUserService;\n[Line 76] +    private final org.eclipse.openvsx.UserService userService;\n[Line 77] +    private final org.springframework.ldap.core.LdapTemplate ldapTemplate;\n[Line 78] +\n[Line 79] +    public SecurityConfig(@Autowired(required = false) LdapConfig ldapConfig, \n[Line 80] +                         @Autowired(required = false) LdapUserService ldapUserService, \n[Line 81] +                         org.eclipse.openvsx.UserService userService, \n[Line 82] +                         @Autowired(required = false) org.springframework.ldap.core.LdapTemplate ldapTemplate) {\n[Line 83] +        this.ldapConfig = ldapConfig;\n[Line 84] +        this.ldapUserService = ldapUserService;\n[Line 85] +        this.userService = userService;\n[Line 86] +        this.ldapTemplate = ldapTemplate;\n[Line 87] +    }\n[Line 88] +\n[Line 89] +    @PostConstruct\n[Line 90] +    public void logSecurityConfig() {\n[Line 91] +        logger.info(\"SecurityConfig - UserSearchBase: '{}', UserSearchFilter: '{}'\", ldapUserSearchBase, ldapUserSearchFilter);\n[Line 92] +    }\n[Line 93] +\n[Line 94] +    @Bean\n[Line 95] +    public org.springframework.web.cors.CorsConfigurationSource corsConfigurationSource() {\n[Line 96] +        var cors = new org.springframework.web.cors.CorsConfiguration();\n[Line 97] +        cors.setAllowedOrigins(java.util.List.of(corsAllowedOrigins.split(\",\")));\n[Line 98] +        cors.setAllowedMethods(java.util.List.of(corsAllowedMethods.split(\",\")));\n[Line 99] +        cors.setAllowedHeaders(java.util.List.of(\"Content-Type\", \"Authorization\", \"X-Requested-With\", \"Accept\", \"Origin\", \"Access-Control-Request-Method\", \"Access-Control-Request-Headers\"));\n[Line 100] +        cors.setAllowCredentials(true);\n[Line 101] +        var source = new org.springframework.web.cors.UrlBasedCorsConfigurationSource();\n[Line 102] +        source.registerCorsConfiguration(\"/**\", cors);\n[Line 103] +        return source;\n[Line 104] +    }\n[Line 105] +\n[Line 106]      @Bean\n[Line 107]      public SecurityFilterChain filterChain(HttpSecurity http, OAuth2UserServices userServices) throws Exception {\n[Line 108]          var filterChain = http.authorizeHttpRequests(\n[Line 109]                  registry -> registry\n-                        .requestMatchers(pathMatchers(\"/*\", \"/login/**\", \"/oauth2/**\", \"/login-providers\", \"/user\", \"/user/auth-error\", \"/logout\", \"/actuator/health/**\", \"/actuator/metrics\", \"/actuator/metrics/**\", \"/actuator/prometheus\", \"/v3/api-docs/**\", \"/swagger-resources/**\", \"/swagger-ui/**\", \"/webjars/**\"))\n[Line 110] +                        .requestMatchers(toMatchers(\"/*\", \"/login/**\", \"/oauth2/**\", \"/login-providers\", \"/user\", \"/user/auth-error\", \"/user/csrf\", \"/logout\", \"/actuator/health/**\", \"/actuator/metrics\", \"/actuator/metrics/**\", \"/actuator/prometheus\", \"/v3/api-docs/**\", \"/swagger-resources/**\", \"/swagger-ui/**\", \"/webjars/**\"))\n[Line 111]                              .permitAll()\n-                        .requestMatchers(pathMatchers(\"/api/*/*/review\", \"/api/*/*/review/delete\", \"/api/user/publish\", \"/api/user/namespace/create\"))\n[Line 112] +                        .requestMatchers(toMatchers(\"/api/*/*/review\", \"/api/*/*/review/delete\", \"/api/user/publish\", \"/api/user/namespace/create\"))\n[Line 113]                              .authenticated()\n-                        .requestMatchers(pathMatchers(\"/api/**\", \"/vscode/**\", \"/documents/**\", \"/admin/api/**\", \"/admin/report\"))\n[Line 114] +                        .requestMatchers(toMatchers(\"/api/**\", \"/vscode/**\", \"/documents/**\", \"/admin/api/**\", \"/admin/report\"))\n[Line 115]                              .permitAll()\n-                        .requestMatchers(pathMatchers(\"/admin/**\"))\n[Line 116] +                        .requestMatchers(toMatchers(\"/admin/**\", \"/ldap-test\"))\n[Line 117]                              .hasAuthority(\"ROLE_ADMIN\")\n-                        .requestMatchers(pathMatchers(frontendRoutes))\n[Line 118] +                        .requestMatchers(toMatchers(frontendRoutes))\n[Line 119]                              .permitAll()\n[Line 120]                          .anyRequest()\n[Line 121]                              .authenticated()\n[Line 122]                  )\n-                .cors(configurer -> configurer.configure(http))\n-                .csrf(configurer -> configurer.ignoringRequestMatchers(pathMatchers(\"/api/-/publish\", \"/api/-/namespace/create\", \"/api/-/query\", \"/vscode/**\", \"/admin/api/**\")))\n[Line 123] +                .cors(org.springframework.security.config.Customizer.withDefaults())\n[Line 124] +                .csrf(configurer -> configurer.disable())\n[Line 125]                  .exceptionHandling(configurer -> configurer.authenticationEntryPoint(new Http403ForbiddenEntryPoint()));\n[Line 126]  \n[Line 127] +        if (ldapConfig != null && ldapConfig.isLdapEnabled()) {\n[Line 128] +            configureLdapAuth(filterChain);\n[Line 129] +        }\n[Line 130]          if (userServices.canLogin()) {\n-            var redirectUrl = StringUtils.isEmpty(webuiUrl) ? \"/\" : webuiUrl;\n-            filterChain.oauth2Login(configurer -> {\n[Line 131] +            configureOAuth2(filterChain, userServices);\n[Line 132] +        }\n[Line 133] +\n[Line 134] +        return filterChain.build();\n[Line 135] +    }\n[Line 136] +\n[Line 137] +    private void configureLdapAuth(HttpSecurity http) throws Exception {\n[Line 138] +        if (ldapTemplate == null || ldapUserService == null) {\n[Line 139] +            logger.warn(\"LDAP dependencies not available, skipping LDAP authentication configuration\");\n[Line 140] +            return;\n[Line 141] +        }\n[Line 142] +        \n[Line 143] +        String redirectUrl = getRedirectUrl();\n[Line 144] +        http.formLogin(configurer -> {\n[Line 145] +            configurer.loginPage(\"/login\")\n[Line 146] +                    .loginProcessingUrl(\"/login\")\n[Line 147] +                    .usernameParameter(\"username\")\n[Line 148] +                    .passwordParameter(\"password\")\n[Line 149] +                    .successHandler(new LdapAuthenticationSuccessHandler(redirectUrl, userService, ldapTemplate, ldapUserSearchBase, ldapGroupSearchBase, ldapGroupSearchFilter, ldapAdminGroups, ldapBase))\n[Line 150] +                    .failureHandler((request, response, exception) -> {\n[Line 151] +                        logger.error(\"LDAP Authentication Failed: \" + exception.getMessage());\n[Line 152] +                        response.setContentType(\"application/json\");\n[Line 153] +                        response.setStatus(401);\n[Line 154] +                        response.getWriter().write(\"{\\\"error\\\":\\\"Invalid username or password\\\"}\");\n[Line 155] +                    })\n[Line 156] +                    .permitAll();\n[Line 157] +        });\n[Line 158] +        try {\n[Line 159] +            http.authenticationProvider(ldapAuthenticationProvider());\n[Line 160] +        } catch (Exception e) {\n[Line 161] +            logger.error(\"LDAP provider not available, skipping LDAP configuration: {}\", e.getMessage());\n[Line 162] +        }\n[Line 163] +    }\n[Line 164] +\n[Line 165] +    private void configureOAuth2(HttpSecurity http, OAuth2UserServices userServices) throws Exception {\n[Line 166] +        String redirectUrl = getRedirectUrl();\n[Line 167] +        http.oauth2Login(configurer -> {\n[Line 168]              configurer.defaultSuccessUrl(redirectUrl);\n[Line 169]              configurer.successHandler(new CustomAuthenticationSuccessHandler(redirectUrl));\n[Line 170]              configurer.failureUrl(redirectUrl + \"?auth-error\");\n[Line 171]              configurer.userInfoEndpoint(customizer -> customizer.oidcUserService(userServices.getOidc()).userService(userServices.getOauth2()));\n[Line 172]          })\n[Line 173]          .logout(configurer -> configurer.logoutSuccessUrl(redirectUrl));\n[Line 174]      }\n[Line 175]  \n-        return filterChain.build();\n[Line 176] +    @Bean\n[Line 177] +    @ConditionalOnProperty(name = \"ovsx.ldap.url\", matchIfMissing = false)\n[Line 178] +    public LdapAuthenticationProvider ldapAuthenticationProvider() {\n[Line 179] +        try {\n[Line 180] +            logger.info(\"Creating LDAP authentication provider with userSearchBase: '{}', userSearchFilter: '{}'\", ldapUserSearchBase, ldapUserSearchFilter);\n[Line 181] +            \n[Line 182] +            var contextSource = ldapConfig.contextSource();\n[Line 183] +            var authenticator = new BindAuthenticator(contextSource);\n[Line 184] +            \n[Line 185] +            if (ldapUserSearchBase != null && !ldapUserSearchBase.isEmpty()) {\n[Line 186] +                var userSearch = new FilterBasedLdapUserSearch(ldapUserSearchBase, ldapUserSearchFilter, contextSource);\n[Line 187] +                authenticator.setUserSearch(userSearch);\n[Line 188] +                logger.info(\"LDAP user search configured: base='{}', filter='{}'\", ldapUserSearchBase, ldapUserSearchFilter);\n[Line 189] +            } else {\n[Line 190] +                logger.warn(\"LDAP userSearchBase is empty, using DN patterns instead\");\n[Line 191] +                authenticator.setUserDnPatterns(new String[]{\"uid={0},\" + ldapUserSearchBase});\n[Line 192] +            }\n[Line 193] +            \n[Line 194] +            LdapAuthoritiesPopulator authoritiesPopulator = new LdapAuthoritiesPopulator() {\n[Line 195] +                @Override\n[Line 196] +                public Collection<? extends GrantedAuthority> getGrantedAuthorities(DirContextOperations userData, String username) {\n[Line 197] +                    try {\n[Line 198] +                        logger.debug(\"Loading authorities for LDAP user: {}\", username);\n[Line 199] +                        UserDetails userDetails = ldapUserService.loadUserByUsername(username);\n[Line 200] +                        return userDetails.getAuthorities();\n[Line 201] +                    } catch (Exception e) {\n[Line 202] +                        logger.warn(\"Failed to load authorities for user '{}': {}\", username, e.getMessage());\n[Line 203] +                        return java.util.Collections.emptyList();\n[Line 204] +                    }\n[Line 205] +                }\n[Line 206] +            };\n[Line 207] +            \n[Line 208] +            var provider = new LdapAuthenticationProvider(authenticator, authoritiesPopulator);\n[Line 209] +            \n[Line 210] +            // Enable strict password comparison to prevent partial password acceptance\n[Line 211] +            provider.setUseAuthenticationRequestCredentials(true);\n[Line 212] +            \n[Line 213] +            logger.info(\"LDAP authentication provider created successfully with strict password validation\");\n[Line 214] +            return provider;\n[Line 215] +        } catch (Exception e) {\n[Line 216] +            logger.error(\"Failed to create LDAP authentication provider: {}\", e.getMessage(), e);\n[Line 217] +            throw e;\n[Line 218] +        }\n[Line 219]      }\n[Line 220]  \n-    private RequestMatcher[] pathMatchers(String... patterns)\n-    {\n-        var pathMatchers = new RequestMatcher[patterns.length];\n-        for(var i = 0; i < patterns.length; i++) {\n-            pathMatchers[i] = PathPatternRequestMatcher.withDefaults().matcher(patterns[i]);\n[Line 221] +    private RequestMatcher[] toMatchers(String... patterns) {\n[Line 222] +        return java.util.Arrays.stream(patterns)\n[Line 223] +            .map(PathPatternRequestMatcher.withDefaults()::matcher)\n[Line 224] +            .toArray(RequestMatcher[]::new);\n[Line 225]      }\n[Line 226]  \n-        return pathMatchers;\n[Line 227] +    private String getRedirectUrl() {\n[Line 228] +        return org.apache.commons.lang3.StringUtils.defaultIfEmpty(webuiUrl, \"http://localhost:3000/\");\n[Line 229]      }\n[Line 230]  }\ndiff --git src://server/src/main/java/org/eclipse/openvsx/security/LdapConnectionTest.java dst://server/src/main/java/org/eclipse/openvsx/security/LdapConnectionTest.java\nnew file mode 100644\nindex 00000000..1e89b907\n--- /dev/null\n+++ dst://server/src/main/java/org/eclipse/openvsx/security/LdapConnectionTest.java\n@@ -0,0 +1,64 @@\n[Line 1] +/********************************************************************************\n[Line 2] + * Copyright (c) 2024 Eclipse Foundation and others\n[Line 3] + *\n[Line 4] + * This program and the accompanying materials are made available under the\n[Line 5] + * terms of the Eclipse Public License v. 2.0 which is available at\n[Line 6] + * http://www.eclipse.org/legal/epl-2.0.\n[Line 7] + *\n[Line 8] + * SPDX-License-Identifier: EPL-2.0\n[Line 9] + ********************************************************************************/\n[Line 10] +package org.eclipse.openvsx.security;\n[Line 11] +\n[Line 12] +import org.slf4j.Logger;\n[Line 13] +import org.slf4j.LoggerFactory;\n[Line 14] +import org.springframework.beans.factory.annotation.Autowired;\n[Line 15] +import org.springframework.beans.factory.annotation.Value;\n[Line 16] +import org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;\n[Line 17] +import org.springframework.ldap.core.LdapTemplate;\n[Line 18] +import org.springframework.stereotype.Component;\n[Line 19] +\n[Line 20] +import jakarta.annotation.PostConstruct;\n[Line 21] +\n[Line 22] +@Component\n[Line 23] +@ConditionalOnProperty(name = \"ovsx.ldap.url\", matchIfMissing = false)\n[Line 24] +public class LdapConnectionTest {\n[Line 25] +\n[Line 26] +    private static final Logger logger = LoggerFactory.getLogger(LdapConnectionTest.class);\n[Line 27] +\n[Line 28] +    @Autowired\n[Line 29] +    private LdapTemplate ldapTemplate;\n[Line 30] +\n[Line 31] +    @Value(\"${ovsx.ldap.userSearchBase:}\")\n[Line 32] +    private String userSearchBase;\n[Line 33] +\n[Line 34] +    @PostConstruct\n[Line 35] +    public void testLdapConnection() {\n[Line 36] +        testConnection();\n[Line 37] +    }\n[Line 38] +    \n[Line 39] +    public boolean testConnection() {\n[Line 40] +        try {\n[Line 41] +            logger.info(\"Testing LDAP connection and user search base...\");\n[Line 42] +            \n[Line 43] +            // Test basic connection\n[Line 44] +            ldapTemplate.lookup(\"\");\n[Line 45] +            logger.info(\"LDAP connection successful\");\n[Line 46] +            \n[Line 47] +            // Test if user search base exists\n[Line 48] +            try {\n[Line 49] +                ldapTemplate.lookup(userSearchBase);\n[Line 50] +                logger.info(\"User search base '{}' exists and is accessible\", userSearchBase);\n[Line 51] +                return true;\n[Line 52] +            } catch (Exception e) {\n[Line 53] +                logger.error(\"User search base '{}' does not exist or is not accessible: {}\", userSearchBase, e.getMessage());\n[Line 54] +                logger.info(\"Please verify the LDAP directory structure and update ovsx.ldap.userSearchBase property\");\n[Line 55] +                return false;\n[Line 56] +            }\n[Line 57] +            \n[Line 58] +        } catch (Exception e) {\n[Line 59] +            logger.error(\"LDAP connection test failed: {}\", e.getMessage());\n[Line 60] +            logger.info(\"Please check LDAP server configuration and connectivity\");\n[Line 61] +            return false;\n[Line 62] +        }\n[Line 63] +    }\n[Line 64] +}\n\\ No newline at end of file\n",
            "role": "user"
        }
    ],
    "model": "hf.co/unsloth/Qwen3-Coder-30B-A3B-Instruct-GGUF:UD-Q4_K_XL",
    "stream": false
}